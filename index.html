<!DOCTYPE html>
<html>
<head>
<title>Who owns B'bos?</title>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.css" />
<script src="http://cdn.leafletjs.com/leaflet-0.7.1/leaflet.js"></script>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="http://d3js.org/topojson.v1.min.js"></script>
</head>

<body>
<div id="map" style="position:absolute;top:0;bottom:0;left:0;right:0;"></div>

<script type="text/javascript">
var map = L.map('map', {
    center: [-34.5878, 19.5707],
    zoom: 16,
    maxBounds: [[-34.621, 19.532], [-34.538, 19.605]],
    minZoom: 12,
    maxZoom: 20
});
L.tileLayer(
    "http://{s}.aerial.openstreetmap.org.za/ngi-aerial/{z}/{x}/{y}.jpg", {
        attribution: 'Aerial photos from <a href="http://www.ngi.gov.za/">CD:NGI</a>'
    }
).addTo(map);

d3.json("bbos.json", function(err, topos) {
    portions = topojson.feature(topos, topos.objects.portion);
    L.geoJson(portions, { onEachFeature: function(f, l) {
        l.bindPopup(f.properties.label + ": " + f.properties.owner);
    }}).addTo(map);
    var ue = L.geoJson(topojson.feature(topos, topos.objects.uedge),
    {
        style: { fill: false, color: "#ff0000", dashArray: "10,7", opacity: 1 }
    });
    ue.getAttribution = function() { return 'Cadastral boundaries from <a href="http://csg.dla.gov.za/">CSG</a>'; };
    ue.addTo(map);
});
</script>
</body>
</html>
